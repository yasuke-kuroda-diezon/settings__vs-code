---
agent: agent
description: メーカー出荷でお届け日を指定されていない注文に指定日が登録されているので、登録されないように修正する。
tools: ["vscode", "execute", "read", "edit", "search", "web", "agent", "todo"]
model: Claude Opus 4.5 (copilot)
---

# 概要

メーカー出荷でお届け日を指定されていない注文に指定日が登録されているので、登録されないように修正する。

# 事象

期待値は以下通りである

No. 出荷元区分 注文エリア グループ倉庫 産直 最短指定可否 お届け希望日の選択肢 指定しない場合のお届け日（営業日15:00まで） 指定しない場合のお届け日（休業日） 指定しない場合のお届け日（営業日15:00以降） 出荷日
1 倉庫 北海道以外 - - 〇 ・当日起算で「着荷指定可能営業日数」に設定した営業日～注文日の14日後までの配送可能日。 注文日の翌日以降で最も早い配送可能日を指定する。 翌営業日の翌日以降で最も早い配送可能日を指定する。 翌日を起算日とし、左記の計算を行う。 -（登録されない）
2 倉庫 北海道 - - 〇 ・当日起算で「着荷指定可能営業日数」に設定した営業日～注文日の14日後までの配送可能日。 "注文日が「営業日」の場合
　注文日から起算して、「翌営業日を 除く 、翌営業日以降で最も早い配送可能日」を指定する。" "・注文日から起算して、「翌翌営業日を 除く 、翌翌営業日以降で最も早い配送可能日」を指定する。
　※「配送可能日」とは、着荷不可日に指定されていない日を指す。" 翌日を起算日とし、左記の計算を行う。 -（登録されない）
3 メーカー 北海道以外 - - ・当日起算で「着荷指定可能営業日数」に設定した営業日～注文日の14日後までの配送可能日。 "- 指定されない
（お届け日が登録されてしまっているので登録されないように修正する）" "- 指定されない
（お届け日が登録されてしまっているので登録されないように修正する）" "- 指定されない
（お届け日が登録されてしまっているので登録されないように修正する）" -（登録されない）
4 メーカー 北海道以外 〇 - ・当日起算で「着荷指定可能営業日数」に設定した営業日～注文日の14日後までの配送可能日。 注文日の翌日以降で最も早い配送可能日を指定する。 翌営業日の翌日以降で最も早い配送可能日を指定する。 翌日を起算日とし、左記の計算を行う。 -（登録されない）
4 メーカー 北海道以外 - 〇 ・当日起算で「着荷指定可能営業日数」に設定した営業日～注文日の14日後までの配送可能日。 - 指定されない - 指定されない - 指定されない "・お届け希望日の2営業前の日を指定
・指定がない場合には、着荷指定可能日数後から2営業日前の日を指定"

# タスク

「- 指定されない （お届け日が登録されてしまっているので登録されないように修正する）」の部分に関して修正を行う。
・既存実装の読み込み
・問題箇所の特定
・修正案の提示
・（修正案の提示に対して承認が得られた場合）修正の実施

# 参考資料

修正 app/Customize/Form/Type/Shopping/OrderShippingLocationType.php
修正 app/Customize/Repository/HolidayRepository.php
追加 app/Customize/Service/ShippingDeliveryService.php
